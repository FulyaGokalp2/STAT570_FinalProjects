<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.404">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mehmet AKSOY (aksoy.mehmet@metu.edu.tr)">
<meta name="author" content="Sercan AKIL (sercan.akil@metu.edu.tr)">

<title>Evaluation of 3D-var Data Assimilation of WRF Temperature Prediction Over Northwestern Türkiye: A Case Study for the Period of 11 and 16 August, 2004</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
<link rel="stylesheet" href="style.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Data Handling and Visualization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../570_project_archery_game_analysis/arc_warden.html"> 
<span class="menu-text">Archery Game</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../LeventSari_HuseyinTan/STAT570_Levent_Huseyin.html"> 
<span class="menu-text">Traffic Accidents</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../PoliceStopData-BuseBakis/project_busebakis.html"> 
<span class="menu-text">PD Stop</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../MehmetAli_STAT570/EnergyWomen570Final.html"> 
<span class="menu-text">Women’s Leadership</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Miray_Ecenaz/STAT570 Final Project.html"> 
<span class="menu-text">DS Job</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Water_Budget/TWS_PRCP_v02.html"> 
<span class="menu-text">TWS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../Maksoy_Sakil/WRF.html" aria-current="page"> 
<span class="menu-text">WRF model</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/FulyaGokalp2/STAT570_FinalProjects" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#numerical-weather-prediction-nwp-models" id="toc-numerical-weather-prediction-nwp-models" class="nav-link" data-scroll-target="#numerical-weather-prediction-nwp-models"><span class="header-section-number">1.1</span> Numerical Weather Prediction (NWP) Models</a></li>
  <li><a href="#data-assimilation" id="toc-data-assimilation" class="nav-link" data-scroll-target="#data-assimilation"><span class="header-section-number">1.2</span> Data Assimilation</a></li>
  <li><a href="#weather-research-and-forecasting-wrf-model" id="toc-weather-research-and-forecasting-wrf-model" class="nav-link" data-scroll-target="#weather-research-and-forecasting-wrf-model"><span class="header-section-number">1.3</span> Weather Research and Forecasting (WRF) model</a></li>
  </ul></li>
  <li><a href="#operations-on-assimilated-wrf-data" id="toc-operations-on-assimilated-wrf-data" class="nav-link" data-scroll-target="#operations-on-assimilated-wrf-data"><span class="header-section-number">2</span> Operations on Assimilated WRF Data</a>
  <ul class="collapse">
  <li><a href="#uploading-necessary-packages" id="toc-uploading-necessary-packages" class="nav-link" data-scroll-target="#uploading-necessary-packages"><span class="header-section-number">2.1</span> Uploading Necessary Packages</a></li>
  <li><a href="#temperature-forecast-of-wrf-in-domain-1" id="toc-temperature-forecast-of-wrf-in-domain-1" class="nav-link" data-scroll-target="#temperature-forecast-of-wrf-in-domain-1"><span class="header-section-number">2.2</span> Temperature Forecast of WRF in Domain 1</a>
  <ul class="collapse">
  <li><a href="#spatial-resolution-domain-1" id="toc-spatial-resolution-domain-1" class="nav-link" data-scroll-target="#spatial-resolution-domain-1"><span class="header-section-number">2.2.1</span> Spatial Resolution (Domain 1)</a></li>
  <li><a href="#forecast-period-time-interval-domain-1" id="toc-forecast-period-time-interval-domain-1" class="nav-link" data-scroll-target="#forecast-period-time-interval-domain-1"><span class="header-section-number">2.2.2</span> Forecast Period &amp; Time Interval (Domain 1)</a></li>
  <li><a href="#study-area-domain-1" id="toc-study-area-domain-1" class="nav-link" data-scroll-target="#study-area-domain-1"><span class="header-section-number">2.2.3</span> Study Area (Domain 1)</a></li>
  </ul></li>
  <li><a href="#temperature-forecast-of-wrf-in-domain-2" id="toc-temperature-forecast-of-wrf-in-domain-2" class="nav-link" data-scroll-target="#temperature-forecast-of-wrf-in-domain-2"><span class="header-section-number">2.3</span> Temperature Forecast of WRF in Domain 2</a>
  <ul class="collapse">
  <li><a href="#spatial-resolution-domain-2" id="toc-spatial-resolution-domain-2" class="nav-link" data-scroll-target="#spatial-resolution-domain-2"><span class="header-section-number">2.3.1</span> Spatial Resolution (Domain 2)</a></li>
  <li><a href="#forecast-period-time-interval-domain-2" id="toc-forecast-period-time-interval-domain-2" class="nav-link" data-scroll-target="#forecast-period-time-interval-domain-2"><span class="header-section-number">2.3.2</span> Forecast Period &amp; Time Interval (Domain 2)</a></li>
  <li><a href="#study-area-domain-2" id="toc-study-area-domain-2" class="nav-link" data-scroll-target="#study-area-domain-2"><span class="header-section-number">2.3.3</span> Study Area (Domain 2)</a></li>
  </ul></li>
  <li><a href="#derivation-of-temperature-prediction-observation" id="toc-derivation-of-temperature-prediction-observation" class="nav-link" data-scroll-target="#derivation-of-temperature-prediction-observation"><span class="header-section-number">2.4</span> Derivation of Temperature Prediction &amp; Observation</a>
  <ul class="collapse">
  <li><a href="#identification-of-meteorological-stations" id="toc-identification-of-meteorological-stations" class="nav-link" data-scroll-target="#identification-of-meteorological-stations"><span class="header-section-number">2.4.1</span> Identification of Meteorological Stations</a></li>
  <li><a href="#obtain-temperature-observations" id="toc-obtain-temperature-observations" class="nav-link" data-scroll-target="#obtain-temperature-observations"><span class="header-section-number">2.4.2</span> Obtain Temperature Observations</a></li>
  <li><a href="#extraction-of-temperature-predictions-from-wrf" id="toc-extraction-of-temperature-predictions-from-wrf" class="nav-link" data-scroll-target="#extraction-of-temperature-predictions-from-wrf"><span class="header-section-number">2.4.3</span> Extraction of Temperature Predictions from WRF</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#operations-on-non-assimilated-wrf-data" id="toc-operations-on-non-assimilated-wrf-data" class="nav-link" data-scroll-target="#operations-on-non-assimilated-wrf-data"><span class="header-section-number">3</span> Operations on Non-Assimilated WRF Data</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">4</span> Results</a>
  <ul class="collapse">
  <li><a href="#derivation-of-data-frames" id="toc-derivation-of-data-frames" class="nav-link" data-scroll-target="#derivation-of-data-frames"><span class="header-section-number">4.1</span> Derivation of Data Frames</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization"><span class="header-section-number">4.2</span> Visualization</a></li>
  <li><a href="#error-analysis" id="toc-error-analysis" class="nav-link" data-scroll-target="#error-analysis"><span class="header-section-number">4.3</span> Error Analysis</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">5</span> Conclusion</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/FulyaGokalp2/STAT570_FinalProjects/edit/main/Maksoy_Sakil/WRF.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/FulyaGokalp2/STAT570_FinalProjects/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Evaluation of 3D-var Data Assimilation of WRF Temperature Prediction Over Northwestern Türkiye: A Case Study for the Period of 11 and 16 August, 2004</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Mehmet AKSOY <em>(aksoy.mehmet@metu.edu.tr)</em> </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Middle East Technical University, Ankara, Türkiye
          </p>
        <p class="affiliation">
            Department of Civil Engineering, Water Resources Lab.
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <p class="author">Sercan AKIL <em>(sercan.akil@metu.edu.tr)</em> </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Middle East Technical University, Ankara, Türkiye
          </p>
        <p class="affiliation">
            Geodetic and Geographic Information Technologies
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>In this project, we have been evaluated temperature prediction of assimilated and non assimilated WRF outputs over Northwestern Türkiye for the period of 11-16 August, 2004. Observation of eleven temperature gauges and corresponding WRF predictions in the study area have been compared. Moreover, predictions were extracted from assimilated and non assimilated raw WRF data of different domains with varied spatio-temporal resolutions by using gauges coordinates. For this purpose, visualization of results and calculation of error proceedings were performed in R programming and Quarto publishing system.</p>
  </div>
</div>


</header>


<div style="text-align: justify">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This document is a product of the final project for the STAT 570 lecture, focusing on data handling and visualization tools. It is essential to acknowledge that minor errors may be present, and the methods employed may not necessarily reflect the optimal approach related to the dataset.</p>
</div>
</div>
</div>
<section id="introduction" class="level1" data-number="1" style="text-align: justify">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<section id="numerical-weather-prediction-nwp-models" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="numerical-weather-prediction-nwp-models"><span class="header-section-number">1.1</span> Numerical Weather Prediction (NWP) Models</h2>
<p>Numerical Weather Prediction (NWP) models are used to predict weather conditions by simulating the atmosphere, oceans, land surface and their interactions. NWP models are based on mathematical equations representing the physical behavior of the atmosphere. These equations are translated into computer code and use governing equations, numerical methods, parameterizations of other physical processes and combined with initial and boundary conditions before running over a geographic area (we call that geographic area as domain). These physical processes need to be approximated in models because of huge simulation computer time which is called as parameterization.</p>
<p>According to ECMWF report, <em>these processes affect too a small area to be predicted in full detail by NWP models. The major reason lies in the limited computing power that still does not allow us to calculate the all processes for any place on Earth</em> <span class="citation" data-cites="frnda2022">(<a href="#ref-frnda2022" role="doc-biblioref">Frnda et al. 2022</a>)</span>.</p>
</section>
<section id="data-assimilation" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="data-assimilation"><span class="header-section-number">1.2</span> Data Assimilation</h2>
<p>NWP models start with an initial value and it is the challenge because initial-value effects next predictions with an increasing error. Thus, updating initial-value prediction is a method to improve prediction accuracy which is called as data assimilation. Infrared radiance from the geostationary satellites and on-site radiosonde observation data assimilation are powerful tools to improve the weather forecast have been widely applied with this purpose in the past a few decades <span class="citation" data-cites="geer2018">(<a href="#ref-geer2018" role="doc-biblioref">Geer et al. 2018</a>)</span>.</p>
<p>There are a number of data assimilation techniques used in weather forecasting. One of the most prominent are the three and four dimensional variational data assimilation methods (3D-var and 4D-var). 3D-var incorporates meteorological data only within a time window around the initialization moment and in this method the analysis increment (an increment is introduced due to the actual observations) does not evolve in time, e.g.&nbsp;it has effect only at the beginning of the simulation. On the other hand 4D-var method uses tangent linear and adjoint models which model the propagation of analysis increment and more computing time is needed <span class="citation" data-cites="vladimirov2020">(<a href="#ref-vladimirov2020" role="doc-biblioref">Vladimirov, Dimitrova, and Danchovski 2020</a>)</span>.</p>
</section>
<section id="weather-research-and-forecasting-wrf-model" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="weather-research-and-forecasting-wrf-model"><span class="header-section-number">1.3</span> Weather Research and Forecasting (WRF) model</h2>
<p>The Weather Research and Forecasting (WRF) model is a next-generation open source mesoscale numerical weather prediction system. As it is open source, it has a very flexible structure that allows it to be used by met-offices, universities and atmospheric research centers <span class="citation" data-cites="powers2017">(<a href="#ref-powers2017" role="doc-biblioref">Powers et al. 2017</a>)</span>. The effort to develop WRF began in the latter 1990’s and was a collaborative partnership of the National Center for Atmospheric Research (NCAR), the National Oceanic and Atmospheric Administration (NOAA), the U.S. Air Force, the Naval Research Laboratory, the University of Oklahoma, and the Federal Aviation Administration (<a href="https://www.mmm.ucar.edu/models/wrf">WRF web page</a>).</p>
<p>The WRF model is used for operational weather forecasting and research purposes at <em>Turkish State Meteorological Service</em> since last two decades, as it is at many meteorological services around the world. It is the fact that data assimilation of observations into WRF model method is very popular not only in Türkiye but also in all over world since it has a great potential to improve model forecast skill by reducing errors of initial conditions <span class="citation" data-cites="yucel2014 yucel2015 bao2015 cheng2017">(<a href="#ref-yucel2014" role="doc-biblioref">Yucel and Onen 2014</a>; <a href="#ref-yucel2015" role="doc-biblioref">Yucel et al. 2015</a>; <a href="#ref-bao2015" role="doc-biblioref">Bao et al. 2015</a>; <a href="#ref-cheng2017" role="doc-biblioref">Cheng et al. 2017</a>)</span>.</p>
</section>
</section>
<section id="operations-on-assimilated-wrf-data" class="level1" data-number="2" style="text-align: justify">
<h1 data-number="2"><span class="header-section-number">2</span> Operations on Assimilated WRF Data</h1>
<p>There are two files for two different domains as assimilated and non-assimilated predictions of WRF model. Thus, there are four netcdf files totally. We are going to define prediction variables, forecast period and coverage of domains for each file.</p>
<section id="uploading-necessary-packages" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="uploading-necessary-packages"><span class="header-section-number">2.1</span> Uploading Necessary Packages</h2>
<p>We need several packages for some implementations in R, for instance; opening of the netcdf files of WRF data, handling of WRF outputs, visualization and similar operations <span class="citation" data-cites="readxl tidyverse ggplot2-2 ggpubr-2 raster rnaturalearth ncdf4 R.utils sf gt">(<a href="#ref-readxl" role="doc-biblioref">Wickham and Bryan 2023</a>; <a href="#ref-tidyverse" role="doc-biblioref">Wickham et al. 2019</a>; <a href="#ref-ggplot2-2" role="doc-biblioref">Wickham 2016</a>; <a href="#ref-ggpubr-2" role="doc-biblioref">Kassambara 2023</a>; <a href="#ref-raster" role="doc-biblioref">Hijmans 2023</a>; <a href="#ref-rnaturalearth" role="doc-biblioref">Massicotte and South 2023</a>; <a href="#ref-ncdf4" role="doc-biblioref">Pierce 2023</a>; <a href="#ref-R.utils" role="doc-biblioref">Bengtsson 2023</a>; <a href="#ref-sf" role="doc-biblioref">Pebesma and Bivand 2023</a>; <a href="#ref-gt" role="doc-biblioref">Iannone et al. 2023</a>)</span>.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-1_9edcf3cf3e53a4cc3324d23d76ae7a60">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ncdf4)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(R.utils)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearthdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="temperature-forecast-of-wrf-in-domain-1" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="temperature-forecast-of-wrf-in-domain-1"><span class="header-section-number">2.2</span> Temperature Forecast of WRF in Domain 1</h2>
<p>The code in the below reads a NetCDF file (fname) using the <code>nc_open</code> function from the <code>ncdf4</code> package. NetCDF is a file format commonly used for storing multidimensional scientific data including NWP model output.</p>
<p>Firstly, we opened the assimilated WRF output for domain 1. By using <code>sink</code> function the content of WRF output at the attachments (<a href="https://github.com/maksoy88bjk/STAT_570_FINAL_PROJECT_MAKSOY-SAKIL/blob/main/aswout/wrfout_d01_2004-08-11_00_00_00.txt" title="wrfout_d01_2004-08-11_00_00_00.txt">wrfout_d01_2004-08-11_00_00_00.txt</a>) can be created. The data cover time and coverage domain information with meteorological predictions such as potential temperature <strong>(T)</strong>, temperature at 2 meter <strong>(T2)</strong>, wind speed at ten meter <strong>(U10 &amp; V10)</strong>, precipitation <strong>(RAINC &amp; RAINNC)</strong> and etc. We need to use name of the variables to extract specific data variables from the raw data.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-2_5af208560db73a437737169e2d843aad">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>fname <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>()),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="st">"/aswout/wrfout_d01_2004-08-11_00_00_00"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>nc_data <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(fname)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>{<span class="fu">sink</span>(<span class="fu">paste0</span>(fname,<span class="st">".txt"</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(nc_data)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sink</span>()}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the WRF data, air temperature at 2 meter <em>(the height of observation at gauges)</em> is available. If 2 meter temperature is not available in netcdf file, the calculation of <a href="http://gradsusr.org/pipermail/gradsusr/2011-December/031698.html">Air Temperature Prediction</a> from WRF data is described at the given link based on <a href="https://www2.mmm.ucar.edu/wrf/users/docs/user_guide_v4/contents.html">WRF manual</a>. In such a case, <em>perturbation potential temperature</em>, <em>base pressure</em> and <em>perturbation pressure</em> variables has to be extracted to get air temperature prediction.</p>
<pre><code>float T2[west_east,south_north,Time]   
    FieldType: 104
    MemoryOrder: XY 
    description: TEMP at 2 M
    units: K
    stagger: 
    coordinates: XLONG XLAT</code></pre>
<section id="spatial-resolution-domain-1" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="spatial-resolution-domain-1"><span class="header-section-number">2.2.1</span> Spatial Resolution (Domain 1)</h3>
<p>Spatial resolution of domain 1 is 12 km as you can see below <em>(DX: 12000, DY:12000)</em>.</p>
<pre><code>78 global attributes:
    TITLE:  OUTPUT FROM WRF V3.1.1 MODEL
    START_DATE: 2004-08-11_00:00:00
    SIMULATION_START_DATE: 2004-08-11_00:00:00
    WEST-EAST_GRID_DIMENSION: 192
    SOUTH-NORTH_GRID_DIMENSION: 116
    BOTTOM-TOP_GRID_DIMENSION: 28
    DX: 12000
    DY: 12000</code></pre>
<p>Here, the code extracts specific variables (longitude, latitude, temperature, and time) from the NetCDF file using the <code>ncvar_get</code>function. There are <strong>41</strong> time steps which means we can get predictions along the domain <strong>(191x115)</strong> for whole period. Additionally, the data includes information for <strong>27</strong> layers from bottom to top of the atmosphere. Fortunately, we do not have to deal with upper layers’ data since we just need to extract temperature predictions at 2 meters.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-3_c87cc813ead791f271ff6229242161df">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>long<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data, <span class="st">"XLONG"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>lat<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data, <span class="st">"XLAT"</span>, <span class="at">verbose =</span> F)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data, <span class="st">"T2"</span>) </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 191 115  41</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">ncvar_get</span>(nc_data, <span class="st">"T"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 191 115  27  41</code></pre>
</div>
</div>
</section>
<section id="forecast-period-time-interval-domain-1" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="forecast-period-time-interval-domain-1"><span class="header-section-number">2.2.2</span> Forecast Period &amp; Time Interval (Domain 1)</h3>
<p>We can also obtained the forecast horizon by getting time steps from the data. After getting time steps, we see that forecast period is between 11 and 16 (00:00 UTC) August, 2004. In this case, the time interval for the forecast period up to +120 hours <em>(or five days)</em> is three hour.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-4_619d3cf587107785cc07b9d9f833c6b4">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data, <span class="st">"Times"</span>); t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "2004-08-11_00:00:00" "2004-08-11_03:00:00" "2004-08-11_06:00:00"
 [4] "2004-08-11_09:00:00" "2004-08-11_12:00:00" "2004-08-11_15:00:00"
 [7] "2004-08-11_18:00:00" "2004-08-11_21:00:00" "2004-08-12_00:00:00"
[10] "2004-08-12_03:00:00" "2004-08-12_06:00:00" "2004-08-12_09:00:00"
[13] "2004-08-12_12:00:00" "2004-08-12_15:00:00" "2004-08-12_18:00:00"
[16] "2004-08-12_21:00:00" "2004-08-13_00:00:00" "2004-08-13_03:00:00"
[19] "2004-08-13_06:00:00" "2004-08-13_09:00:00" "2004-08-13_12:00:00"
[22] "2004-08-13_15:00:00" "2004-08-13_18:00:00" "2004-08-13_21:00:00"
[25] "2004-08-14_00:00:00" "2004-08-14_03:00:00" "2004-08-14_06:00:00"
[28] "2004-08-14_09:00:00" "2004-08-14_12:00:00" "2004-08-14_15:00:00"
[31] "2004-08-14_18:00:00" "2004-08-14_21:00:00" "2004-08-15_00:00:00"
[34] "2004-08-15_03:00:00" "2004-08-15_06:00:00" "2004-08-15_09:00:00"
[37] "2004-08-15_12:00:00" "2004-08-15_15:00:00" "2004-08-15_18:00:00"
[40] "2004-08-15_21:00:00" "2004-08-16_00:00:00"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hms</span>(t[<span class="dv">41</span>]) <span class="sc">-</span> <span class="fu">ymd_hms</span>(t[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 5 days</code></pre>
</div>
</div>
</section>
<section id="study-area-domain-1" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="study-area-domain-1"><span class="header-section-number">2.2.3</span> Study Area (Domain 1)</h3>
<p><a href="#fig-domain1" class="quarto-xref">Figure&nbsp;1</a> below shows the coverage of domain 1 where covers Türkiye and its surrounding. The code in the below creates a list of raster objects for each time step from the extracted temperature from raw WRF data set. Kelvin unit has been converted into Celcius by implementing -273.15. Raster objects are used for working with gridded spatial data. Additionally, <code>ggplot2</code> package is used to create a map visualization. It overlays the temperature data onto a map of countries, setting up appropriate coordinate systems and color scales.</p>
<div class="cell" data-hash="WRF_cache/html/fig-domain1_e28e114a692ac223f7cd5884a19ca786">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>raster_temp<span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(temp)[<span class="dv">3</span>])   {</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    raster_temp[[i]] <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(temp[, , i] <span class="sc">-</span> <span class="fl">273.15</span>), </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">xmn=</span><span class="fu">min</span>(long), <span class="at">xmx=</span><span class="fu">max</span>(long),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">ymn=</span><span class="fu">min</span>(lat), <span class="at">ymx=</span><span class="fu">max</span>(lat), </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">crs=</span><span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"</span>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>temp_df <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(raster_temp[[<span class="fu">length</span>(t)]], <span class="at">xy =</span> <span class="cn">TRUE</span>) </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> rnaturalearth<span class="sc">::</span><span class="fu">ne_countries</span>(<span class="at">scale=</span><span class="st">'medium'</span>,<span class="at">returnclass =</span> <span class="st">'sf'</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world)  <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">55</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">50</span>)) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> temp_df, <span class="fu">aes</span>(x, y, <span class="at">fill =</span> layer), <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">35</span>)) <span class="sc">+</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">""</span>, <span class="at">fill=</span> <span class="fu">expression</span>(degree<span class="sc">*</span>C)) <span class="sc">+</span> </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Coverage of Domain 1"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"cm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-domain1" class="quarto-figure quarto-figure-center anchored" width="864">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-domain1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="WRF_files/figure-html/fig-domain1-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-domain1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Türkiye with its neighboring countries and coverage of domain 1 for assimilated-WRF predictions.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="temperature-forecast-of-wrf-in-domain-2" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="temperature-forecast-of-wrf-in-domain-2"><span class="header-section-number">2.3</span> Temperature Forecast of WRF in Domain 2</h2>
<p>There are <strong>121</strong> time steps for second domain since we can inference by dimension of <strong>T2</strong> data.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-6_901de6f7759e553e484d7801e86aee33">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fname2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>()),</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="st">"/aswout/wrfout_d02_2004-08-11_00_00_00"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>nc_data2 <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(fname2)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>{<span class="fu">sink</span>(<span class="fu">paste0</span>(fname2,<span class="st">".txt"</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(nc_data2)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sink</span>()}</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>long_2<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data2, <span class="st">"XLONG"</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>lat_2<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data2, <span class="st">"XLAT"</span>, <span class="at">verbose =</span> F)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>temp_2<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data2, <span class="st">"T2"</span>) </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(temp_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 132  63 121</code></pre>
</div>
</div>
<section id="spatial-resolution-domain-2" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="spatial-resolution-domain-2"><span class="header-section-number">2.3.1</span> Spatial Resolution (Domain 2)</h3>
<p>Spatial resolution of domain 2 is 4 km which is a finer resolution than previous one <em>(DX: 4000, DY: 4000)</em>.</p>
<pre><code>78 global attributes:
    TITLE:  OUTPUT FROM WRF V3.1.1 MODEL
    START_DATE: 2004-08-11_00:00:00
    SIMULATION_START_DATE: 2004-08-11_00:00:00
    WEST-EAST_GRID_DIMENSION: 133
    SOUTH-NORTH_GRID_DIMENSION: 64
    BOTTOM-TOP_GRID_DIMENSION: 28
    DX: 4000
    DY: 4000</code></pre>
</section>
<section id="forecast-period-time-interval-domain-2" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="forecast-period-time-interval-domain-2"><span class="header-section-number">2.3.2</span> Forecast Period &amp; Time Interval (Domain 2)</h3>
<p>Forecast period for domain 2 is same with previous one. However, the time interval is one hour and it has a finer temporal resolution.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-7_d61656aadb8ec1e27bb8e9e47a9bd315">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data2, <span class="st">"Times"</span>); t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "2004-08-11_00:00:00" "2004-08-11_01:00:00" "2004-08-11_02:00:00"
  [4] "2004-08-11_03:00:00" "2004-08-11_04:00:00" "2004-08-11_05:00:00"
  [7] "2004-08-11_06:00:00" "2004-08-11_07:00:00" "2004-08-11_08:00:00"
 [10] "2004-08-11_09:00:00" "2004-08-11_10:00:00" "2004-08-11_11:00:00"
 [13] "2004-08-11_12:00:00" "2004-08-11_13:00:00" "2004-08-11_14:00:00"
 [16] "2004-08-11_15:00:00" "2004-08-11_16:00:00" "2004-08-11_17:00:00"
 [19] "2004-08-11_18:00:00" "2004-08-11_19:00:00" "2004-08-11_20:00:00"
 [22] "2004-08-11_21:00:00" "2004-08-11_22:00:00" "2004-08-11_23:00:00"
 [25] "2004-08-12_00:00:00" "2004-08-12_01:00:00" "2004-08-12_02:00:00"
 [28] "2004-08-12_03:00:00" "2004-08-12_04:00:00" "2004-08-12_05:00:00"
 [31] "2004-08-12_06:00:00" "2004-08-12_07:00:00" "2004-08-12_08:00:00"
 [34] "2004-08-12_09:00:00" "2004-08-12_10:00:00" "2004-08-12_11:00:00"
 [37] "2004-08-12_12:00:00" "2004-08-12_13:00:00" "2004-08-12_14:00:00"
 [40] "2004-08-12_15:00:00" "2004-08-12_16:00:00" "2004-08-12_17:00:00"
 [43] "2004-08-12_18:00:00" "2004-08-12_19:00:00" "2004-08-12_20:00:00"
 [46] "2004-08-12_21:00:00" "2004-08-12_22:00:00" "2004-08-12_23:00:00"
 [49] "2004-08-13_00:00:00" "2004-08-13_01:00:00" "2004-08-13_02:00:00"
 [52] "2004-08-13_03:00:00" "2004-08-13_04:00:00" "2004-08-13_05:00:00"
 [55] "2004-08-13_06:00:00" "2004-08-13_07:00:00" "2004-08-13_08:00:00"
 [58] "2004-08-13_09:00:00" "2004-08-13_10:00:00" "2004-08-13_11:00:00"
 [61] "2004-08-13_12:00:00" "2004-08-13_13:00:00" "2004-08-13_14:00:00"
 [64] "2004-08-13_15:00:00" "2004-08-13_16:00:00" "2004-08-13_17:00:00"
 [67] "2004-08-13_18:00:00" "2004-08-13_19:00:00" "2004-08-13_20:00:00"
 [70] "2004-08-13_21:00:00" "2004-08-13_22:00:00" "2004-08-13_23:00:00"
 [73] "2004-08-14_00:00:00" "2004-08-14_01:00:00" "2004-08-14_02:00:00"
 [76] "2004-08-14_03:00:00" "2004-08-14_04:00:00" "2004-08-14_05:00:00"
 [79] "2004-08-14_06:00:00" "2004-08-14_07:00:00" "2004-08-14_08:00:00"
 [82] "2004-08-14_09:00:00" "2004-08-14_10:00:00" "2004-08-14_11:00:00"
 [85] "2004-08-14_12:00:00" "2004-08-14_13:00:00" "2004-08-14_14:00:00"
 [88] "2004-08-14_15:00:00" "2004-08-14_16:00:00" "2004-08-14_17:00:00"
 [91] "2004-08-14_18:00:00" "2004-08-14_19:00:00" "2004-08-14_20:00:00"
 [94] "2004-08-14_21:00:00" "2004-08-14_22:00:00" "2004-08-14_23:00:00"
 [97] "2004-08-15_00:00:00" "2004-08-15_01:00:00" "2004-08-15_02:00:00"
[100] "2004-08-15_03:00:00" "2004-08-15_04:00:00" "2004-08-15_05:00:00"
[103] "2004-08-15_06:00:00" "2004-08-15_07:00:00" "2004-08-15_08:00:00"
[106] "2004-08-15_09:00:00" "2004-08-15_10:00:00" "2004-08-15_11:00:00"
[109] "2004-08-15_12:00:00" "2004-08-15_13:00:00" "2004-08-15_14:00:00"
[112] "2004-08-15_15:00:00" "2004-08-15_16:00:00" "2004-08-15_17:00:00"
[115] "2004-08-15_18:00:00" "2004-08-15_19:00:00" "2004-08-15_20:00:00"
[118] "2004-08-15_21:00:00" "2004-08-15_22:00:00" "2004-08-15_23:00:00"
[121] "2004-08-16_00:00:00"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ymd_hms</span>(t2[<span class="dv">121</span>]) <span class="sc">-</span> <span class="fu">ymd_hms</span>(t2[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 5 days</code></pre>
</div>
</div>
</section>
<section id="study-area-domain-2" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="study-area-domain-2"><span class="header-section-number">2.3.3</span> Study Area (Domain 2)</h3>
<p><a href="#fig-domain2" class="quarto-xref">Figure&nbsp;2</a> below shows the comparison of two domains and coverage of domain 2 where covers some part of northwest of Türkiye. It is clearly seen that the intersection of domain 1 and 2 is the entire domain 2. Thus, our study area become only the entire domain 2.</p>
<div class="cell" data-hash="WRF_cache/html/fig-domain2_7b6f0026867840f56c2e6fa6ec44b2fa">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>raster_temp_2<span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(temp_2)[<span class="dv">3</span>])   {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  raster_temp_2[[i]] <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(temp_2[, , i] <span class="sc">-</span> <span class="fl">273.15</span>), </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xmn=</span><span class="fu">min</span>(long_2), <span class="at">xmx=</span><span class="fu">max</span>(long_2),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ymn=</span><span class="fu">min</span>(lat_2), <span class="at">ymx=</span><span class="fu">max</span>(lat_2), </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">crs=</span><span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"</span>))</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                              }</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>temp_df_2 <span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(raster_temp_2[[<span class="fu">length</span>(t2)]], <span class="at">xy =</span> <span class="cn">TRUE</span>) </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>world <span class="ot">&lt;-</span> rnaturalearth<span class="sc">::</span><span class="fu">ne_countries</span>(<span class="at">scale=</span><span class="st">'medium'</span>,<span class="at">returnclass =</span> <span class="st">'sf'</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world)  <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="fl">47.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">33.5</span>,<span class="dv">47</span>)) <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> temp_df, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(x, y, <span class="at">fill=</span> layer), <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> temp_df_2, </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(x, y, <span class="at">fill=</span> layer), <span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Coverage of Domain 2"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-domain2" class="quarto-figure quarto-figure-center anchored" width="864">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-domain2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="WRF_files/figure-html/fig-domain2-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-domain2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Comparison of domain 1 and 2.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="derivation-of-temperature-prediction-observation" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="derivation-of-temperature-prediction-observation"><span class="header-section-number">2.4</span> Derivation of Temperature Prediction &amp; Observation</h2>
<section id="identification-of-meteorological-stations" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="identification-of-meteorological-stations"><span class="header-section-number">2.4.1</span> Identification of Meteorological Stations</h3>
<p>Domain 2 covers several provinces which are located northwest of Türkiye. Thus, we need to determine meteorological stations for comparing observation versus assimilated and non-assimilated WRF predictions. The code in the chunk reads data from a delimited text file containing information about meteorological stations. Each specific station was selected for each province to evaluate the performance of both assimilated and non-assimilated WRF predictions. <a href="#tbl-gauges-domain2" class="quarto-xref">Table&nbsp;1</a> shows the main gauges across the domain 2.</p>
<p>The code uses the <code>dplyr</code> and <code>gt</code> packages for data manipulation and table creation. It assist to perform data wrangling and cleaning on the meteorological station data, containing renaming columns, converting province names, and arranging the data. The <code>tolower</code> function is used to convert the province names to lowercase. The <code>str_to_title()</code> function from the <code>stringr</code> package is applied to convert the province names’ first letter to title case.</p>
<div class="cell" data-hash="WRF_cache/html/tbl-gauges-domain2_f1383a3d736a2181c9d000184d28a30d">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df_gauges <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="fu">paste0</span>(<span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>()),<span class="st">"/gauges.txt"</span>), <span class="at">sep=</span><span class="st">"|"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df_gauges<span class="ot">&lt;-</span> df_gauges[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)]</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_gauges)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"Province"</span>,<span class="st">"Latitude"</span>,<span class="st">"Longitude"</span>,<span class="st">"Altitude"</span>) </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>df_gauges<span class="sc">$</span>Province <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df_gauges<span class="sc">$</span>Province) <span class="sc">|&gt;</span> <span class="fu">str_to_title</span>() </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>df_gauges<span class="ot">&lt;-</span> df_gauges <span class="sc">|&gt;</span> <span class="fu">arrange</span>(Station) </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>df_gauges <span class="sc">|&gt;</span>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-gauges-domain2" class="cell anchored" data-hash="WRF_cache/html/tbl-gauges-domain2_f1383a3d736a2181c9d000184d28a30d">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="table quarto-float-caption quarto-float-tbl" id="tbl-gauges-domain2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Meteorological stations accross the domain 2.
</figcaption>
<div aria-describedby="tbl-gauges-domain2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="heeooyfcnr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#heeooyfcnr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#heeooyfcnr thead, #heeooyfcnr tbody, #heeooyfcnr tfoot, #heeooyfcnr tr, #heeooyfcnr td, #heeooyfcnr th {
  border-style: none;
}

#heeooyfcnr p {
  margin: 0;
  padding: 0;
}

#heeooyfcnr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#heeooyfcnr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#heeooyfcnr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#heeooyfcnr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#heeooyfcnr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#heeooyfcnr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#heeooyfcnr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#heeooyfcnr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#heeooyfcnr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#heeooyfcnr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#heeooyfcnr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#heeooyfcnr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#heeooyfcnr .gt_spanner_row {
  border-bottom-style: hidden;
}

#heeooyfcnr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#heeooyfcnr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#heeooyfcnr .gt_from_md > :first-child {
  margin-top: 0;
}

#heeooyfcnr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#heeooyfcnr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#heeooyfcnr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#heeooyfcnr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#heeooyfcnr .gt_row_group_first td {
  border-top-width: 2px;
}

#heeooyfcnr .gt_row_group_first th {
  border-top-width: 2px;
}

#heeooyfcnr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#heeooyfcnr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#heeooyfcnr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#heeooyfcnr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#heeooyfcnr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#heeooyfcnr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#heeooyfcnr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#heeooyfcnr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#heeooyfcnr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#heeooyfcnr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#heeooyfcnr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#heeooyfcnr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#heeooyfcnr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#heeooyfcnr .gt_left {
  text-align: left;
}

#heeooyfcnr .gt_center {
  text-align: center;
}

#heeooyfcnr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#heeooyfcnr .gt_font_normal {
  font-weight: normal;
}

#heeooyfcnr .gt_font_bold {
  font-weight: bold;
}

#heeooyfcnr .gt_font_italic {
  font-style: italic;
}

#heeooyfcnr .gt_super {
  font-size: 65%;
}

#heeooyfcnr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#heeooyfcnr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#heeooyfcnr .gt_indent_1 {
  text-indent: 5px;
}

#heeooyfcnr .gt_indent_2 {
  text-indent: 10px;
}

#heeooyfcnr .gt_indent_3 {
  text-indent: 15px;
}

#heeooyfcnr .gt_indent_4 {
  text-indent: 20px;
}

#heeooyfcnr .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Station" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Station</th>
<th id="Province" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Province</th>
<th id="Latitude" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Latitude</th>
<th id="Longitude" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Longitude</th>
<th id="Altitude" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Altitude</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="Station">17020</td>
<td class="gt_row gt_left" headers="Province">Bartin</td>
<td class="gt_row gt_right" headers="Latitude">41.62480</td>
<td class="gt_row gt_right" headers="Longitude">32.35690</td>
<td class="gt_row gt_right" headers="Altitude">33</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Station">17022</td>
<td class="gt_row gt_left" headers="Province">Zonguldak</td>
<td class="gt_row gt_right" headers="Latitude">41.44924</td>
<td class="gt_row gt_right" headers="Longitude">31.77792</td>
<td class="gt_row gt_right" headers="Altitude">135</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Station">17026</td>
<td class="gt_row gt_left" headers="Province">Sinop</td>
<td class="gt_row gt_right" headers="Latitude">42.02990</td>
<td class="gt_row gt_right" headers="Longitude">35.15450</td>
<td class="gt_row gt_right" headers="Altitude">32</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Station">17069</td>
<td class="gt_row gt_left" headers="Province">Sakarya</td>
<td class="gt_row gt_right" headers="Latitude">40.76760</td>
<td class="gt_row gt_right" headers="Longitude">30.39340</td>
<td class="gt_row gt_right" headers="Altitude">30</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Station">17070</td>
<td class="gt_row gt_left" headers="Province">Bolu</td>
<td class="gt_row gt_right" headers="Latitude">40.73290</td>
<td class="gt_row gt_right" headers="Longitude">31.60220</td>
<td class="gt_row gt_right" headers="Altitude">743</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Station">17072</td>
<td class="gt_row gt_left" headers="Province">Duzce</td>
<td class="gt_row gt_right" headers="Latitude">40.84370</td>
<td class="gt_row gt_right" headers="Longitude">31.14880</td>
<td class="gt_row gt_right" headers="Altitude">146</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Station">17074</td>
<td class="gt_row gt_left" headers="Province">Kastamonu</td>
<td class="gt_row gt_right" headers="Latitude">41.37100</td>
<td class="gt_row gt_right" headers="Longitude">33.77560</td>
<td class="gt_row gt_right" headers="Altitude">800</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Station">17080</td>
<td class="gt_row gt_left" headers="Province">Cankiri</td>
<td class="gt_row gt_right" headers="Latitude">40.60820</td>
<td class="gt_row gt_right" headers="Longitude">33.61020</td>
<td class="gt_row gt_right" headers="Altitude">755</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Station">17084</td>
<td class="gt_row gt_left" headers="Province">Corum</td>
<td class="gt_row gt_right" headers="Latitude">40.54610</td>
<td class="gt_row gt_right" headers="Longitude">34.93620</td>
<td class="gt_row gt_right" headers="Altitude">776</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="Station">17085</td>
<td class="gt_row gt_left" headers="Province">Amasya</td>
<td class="gt_row gt_right" headers="Latitude">40.66680</td>
<td class="gt_row gt_right" headers="Longitude">35.83530</td>
<td class="gt_row gt_right" headers="Altitude">409</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="Station">17622</td>
<td class="gt_row gt_left" headers="Province">Samsun</td>
<td class="gt_row gt_right" headers="Latitude">41.55150</td>
<td class="gt_row gt_right" headers="Longitude">35.92470</td>
<td class="gt_row gt_right" headers="Altitude">103</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#fig-gauges" class="quarto-xref">Figure&nbsp;3</a> is shown for distribution of meteorological stations across the study area.</p>
<div class="cell" data-hash="WRF_cache/html/fig-gauges_f9a2cdb0bbb2a569588da4743c802db6">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>extents<span class="ot">&lt;-</span> <span class="fu">extent</span>(raster_temp_2[[<span class="fu">length</span>(t2)]])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> world)  <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>), <span class="at">xlim =</span> <span class="fu">c</span>(extents[<span class="dv">1</span>], extents[<span class="dv">2</span>]), </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">ylim =</span> <span class="fu">c</span>(extents[<span class="dv">3</span>],extents[<span class="dv">4</span>])) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="at">data =</span> temp_df_2, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(x, y, <span class="at">fill =</span> layer), <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">25</span>)) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">""</span>, <span class="at">fill=</span> <span class="fu">expression</span>(degree<span class="sc">*</span>C)) <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_gauges, <span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">size=</span><span class="dv">3</span>, <span class="at">colour=</span><span class="st">"darkred"</span>) <span class="sc">+</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span> df_gauges, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>Longitude, <span class="at">y=</span>Latitude, </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">label=</span>Province), <span class="at">nudge_y =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Hourly Assimilated WRF Temperature Forecast,"</span>, t2[<span class="dv">121</span>])) <span class="sc">+</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key.width=</span><span class="fu">unit</span>(<span class="dv">3</span>,<span class="st">"cm"</span>), <span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-gauges" class="quarto-figure quarto-figure-center anchored" width="864">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gauges-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="WRF_files/figure-html/fig-gauges-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-gauges-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Distribution of Meteorological Stations Over Domain 2.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="obtain-temperature-observations" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="obtain-temperature-observations"><span class="header-section-number">2.4.2</span> Obtain Temperature Observations</h3>
<p>The code reads temperature observations from an excel file. In the raw data, there is no date column but it has multiple columns which are defined for year, month, day and hour information. Therefore, we need to convert them into the single date column by merging them. Then, these columns can be removed by non-selecting. In the raw data set, some dates can be missing. However, these are not defined as <code>null</code>. Therefore, leaping values can be detected then it assigned as a <code>null</code> by using <code>complete</code> function.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-11_21c8617f431d10c54b07c59c9dd9b967">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>temp_obs<span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="fu">paste0</span>(<span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>()),</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="st">"/observation.xlsx"</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(temp_obs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  Istasyon_No Istasyon_Adi   YIL    AY   GUN  SAAT SICAKLIK
        &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1       17020 BARTIN        2004     8    10     0     18.7
2       17020 BARTIN        2004     8    10     1     18.3
3       17020 BARTIN        2004     8    10     2     18  
4       17020 BARTIN        2004     8    10     3     17.1
5       17020 BARTIN        2004     8    10     4     17.6
6       17020 BARTIN        2004     8    10     5     18.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>temp_obs<span class="ot">&lt;-</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  temp_obs <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date=</span> <span class="fu">as.Date</span>(<span class="fu">with</span>(temp_obs, <span class="fu">paste</span>(YIL,AY,GUN,<span class="at">sep=</span><span class="st">"-"</span>)),<span class="st">"%Y-%m-%d"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dates=</span> <span class="fu">ymd_hms</span>(<span class="fu">paste</span>(date, <span class="fu">paste</span>(SAAT, <span class="dv">0</span>, <span class="dv">0</span>, <span class="at">sep =</span> <span class="st">":"</span>)), <span class="at">tz=</span><span class="st">"UTC"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Istasyon_No, dates, SICAKLIK) <span class="sc">|&gt;</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Istasyon_No) <span class="sc">|&gt;</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">complete</span>( <span class="at">dates =</span> <span class="fu">seq</span>(<span class="fu">ymd_hm</span>(<span class="st">"2004-08-10 00:00"</span>), </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ymd_hm</span>(<span class="st">"2004-08-16 23:00"</span>), <span class="at">by =</span> <span class="st">"1 hours"</span>))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(temp_obs)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(temp_obs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
# Groups:   Station [1]
  Station dates               observation
    &lt;dbl&gt; &lt;dttm&gt;                    &lt;dbl&gt;
1   17020 2004-08-10 00:00:00        18.7
2   17020 2004-08-10 01:00:00        18.3
3   17020 2004-08-10 02:00:00        18  
4   17020 2004-08-10 03:00:00        17.1
5   17020 2004-08-10 04:00:00        17.6
6   17020 2004-08-10 05:00:00        18.3</code></pre>
</div>
</div>
</section>
<section id="extraction-of-temperature-predictions-from-wrf" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="extraction-of-temperature-predictions-from-wrf"><span class="header-section-number">2.4.3</span> Extraction of Temperature Predictions from WRF</h3>
<p>This code stacks raster layers (since time is not constant) and extracts temperature values for meteorological station locations. Gauge locations and prediction values with time need to be combined and data frame columns need to be renamed after extraction procedure. The table below contains three-hour temperature predictions for each province/gauge in domain 1.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-12_0330fe47af5939a82947c0496aa9c50c">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>centroids <span class="ot">&lt;-</span> df_gauges[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>)]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coordinates</span>(centroids)<span class="ot">=</span> <span class="er">~</span> Longitude <span class="sc">+</span> Latitude</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># domain1</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>raster_temp_stack<span class="ot">&lt;-</span> <span class="fu">stack</span>(raster_temp)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>raster_temp_value<span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(raster_temp_stack, centroids)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>rt_cpv <span class="ot">&lt;-</span> <span class="fu">cbind</span>(centroids,raster_temp_value)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>rt_cpv_df<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rt_cpv)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rt_cpv_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Station"   "layer.1"   "layer.2"   "layer.3"   "layer.4"   "layer.5"  
 [7] "layer.6"   "layer.7"   "layer.8"   "layer.9"   "layer.10"  "layer.11" 
[13] "layer.12"  "layer.13"  "layer.14"  "layer.15"  "layer.16"  "layer.17" 
[19] "layer.18"  "layer.19"  "layer.20"  "layer.21"  "layer.22"  "layer.23" 
[25] "layer.24"  "layer.25"  "layer.26"  "layer.27"  "layer.28"  "layer.29" 
[31] "layer.30"  "layer.31"  "layer.32"  "layer.33"  "layer.34"  "layer.35" 
[37] "layer.36"  "layer.37"  "layer.38"  "layer.39"  "layer.40"  "layer.41" 
[43] "Longitude" "Latitude"  "optional" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>rt_cpv_df<span class="ot">&lt;-</span> rt_cpv_df[,<span class="sc">-</span><span class="fu">ncol</span>(rt_cpv_df)]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rt_cpv_df)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Station  layer.1  layer.2  layer.3  layer.4
1   17020 19.14172 16.38781 18.63476 22.33074
2   17022 18.32778 17.36398 20.07202 23.92535
3   17026 20.14706 18.49960 20.52038 19.43371
4   17069 17.88046 15.75091 16.23025 19.67379
5   17070 16.78866 13.52252 16.43801 19.22317
6   17072 17.22476 14.45699 16.89929 19.99230</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>rt_cpv_df<span class="ot">&lt;-</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  rt_cpv_df <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Station, Longitude, Latitude,  <span class="fu">everything</span>() )</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rt_cpv_df) <span class="ot">&lt;-</span> <span class="fu">append</span>(<span class="fu">colnames</span>(rt_cpv_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),<span class="fu">as.character</span>(t))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rt_cpv_df)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Station Longitude Latitude 2004-08-11_00:00:00 2004-08-11_03:00:00
1   17020  32.35690 41.62480            19.14172            16.38781
2   17022  31.77792 41.44924            18.32778            17.36398
3   17026  35.15450 42.02990            20.14706            18.49960
4   17069  30.39340 40.76760            17.88046            15.75091
5   17070  31.60220 40.73290            16.78866            13.52252
6   17072  31.14880 40.84370            17.22476            14.45699</code></pre>
</div>
</div>
<p>Same procedures applied in previous chunk has to be followed for assimilated data but for domain 2.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-13_451412ab22c78b73bff3e9c8de5ff946">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># domain2</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>raster_temp_stack_2<span class="ot">&lt;-</span> <span class="fu">stack</span>(raster_temp_2)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>raster_temp_value_2<span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(raster_temp_stack_2, centroids)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>rt_cpv_2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(centroids,raster_temp_value_2)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_2<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rt_cpv_2) </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_2<span class="ot">&lt;-</span> rt_cpv_df_2[,<span class="sc">-</span><span class="fu">ncol</span>(rt_cpv_df_2)]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_2<span class="ot">&lt;-</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  rt_cpv_df_2 <span class="sc">|&gt;</span> </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Station, Longitude, Latitude,  <span class="fu">everything</span>() )</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rt_cpv_df_2)<span class="ot">&lt;-</span> <span class="fu">append</span>(<span class="fu">colnames</span>(rt_cpv_df_2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),<span class="fu">as.character</span>(t2))</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rt_cpv_df_2)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Station Longitude Latitude 2004-08-11_00:00:00 2004-08-11_01:00:00
1   17020  32.35690 41.62480            16.26486            12.88519
2   17022  31.77792 41.44924            16.93813            14.32098
3   17026  35.15450 42.02990            17.94399            18.06762
4   17069  30.39340 40.76760            20.76284            23.30419
5   17070  31.60220 40.73290            20.05142            22.39242
6   17072  31.14880 40.84370            20.31973            22.24160</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="operations-on-non-assimilated-wrf-data" class="level1" data-number="3" style="text-align: justify">
<h1 data-number="3"><span class="header-section-number">3</span> Operations on Non-Assimilated WRF Data</h1>
<p>We need to apply similar procedures on non-assimilated WRF predictions for extraction as shown above.</p>
</section>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-14_98d8abe783bc930e9616573e2097eaae">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#domain1</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fname_nas <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>()),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="st">"/wout/wrfout_d01_2004-08-11_00_00_00"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>nc_data_nas <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(fname_nas)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>{<span class="fu">sink</span>(<span class="fu">paste0</span>(fname_nas,<span class="st">".txt"</span>))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(nc_data_nas)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sink</span>()}</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>long_nas<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data_nas, <span class="st">"XLONG"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>lat_nas<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data_nas, <span class="st">"XLAT"</span>, <span class="at">verbose =</span> F)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>temp_nas<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data_nas, <span class="st">"T2"</span>) </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>t_nas <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data_nas, <span class="st">"Times"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>raster_temp_nas<span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(temp_nas)[<span class="dv">3</span>])   {</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    raster_temp_nas[[i]] <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(temp_nas[, , i] <span class="sc">-</span> <span class="fl">273.15</span>), </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">xmn=</span><span class="fu">min</span>(long_nas), <span class="at">xmx=</span><span class="fu">max</span>(long_nas),</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">ymn=</span><span class="fu">min</span>(lat_nas), <span class="at">ymx=</span><span class="fu">max</span>(lat_nas), </span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">crs=</span><span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"</span>))</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co">#domain2</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>fname2_nas <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">setwd</span>(here<span class="sc">::</span><span class="fu">here</span>()),</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="st">"/wout/wrfout_d02_2004-08-11_00_00_00"</span>)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>nc_data2_nas <span class="ot">&lt;-</span> <span class="fu">nc_open</span>(fname2_nas)</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>{<span class="fu">sink</span>(<span class="fu">paste0</span>(fname2_nas,<span class="st">".txt"</span>))</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(nc_data2_nas)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sink</span>()}</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>long_2_nas<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data2_nas, <span class="st">"XLONG"</span>)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>lat_2_nas<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data2_nas, <span class="st">"XLAT"</span>, <span class="at">verbose =</span> F)</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>temp_2_nas<span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data2_nas, <span class="st">"T2"</span>) </span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>t2_nas <span class="ot">&lt;-</span> <span class="fu">ncvar_get</span>(nc_data2_nas, <span class="st">"Times"</span>)</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>raster_temp_2_nas<span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(temp_2_nas)[<span class="dv">3</span>])   {</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    raster_temp_2_nas[[i]] <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="fu">t</span>(temp_2_nas[, , i] <span class="sc">-</span> <span class="fl">273.15</span>), </span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">xmn=</span><span class="fu">min</span>(long_2_nas), <span class="at">xmx=</span><span class="fu">max</span>(long_2_nas),</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">ymn=</span><span class="fu">min</span>(lat_2_nas), <span class="at">ymx=</span><span class="fu">max</span>(lat_2_nas), </span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">crs=</span><span class="fu">CRS</span>(<span class="st">"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs+ towgs84=0,0,0"</span>))</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="co"># domain1</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>raster_temp_stack_nas<span class="ot">&lt;-</span> <span class="fu">stack</span>(raster_temp_nas)</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>raster_temp_value_nas<span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(raster_temp_stack_nas, centroids)</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>rt_cpv_nas <span class="ot">&lt;-</span> <span class="fu">cbind</span>(centroids,raster_temp_value_nas)</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_nas<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rt_cpv_nas)</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_nas<span class="ot">&lt;-</span> rt_cpv_df_nas[,<span class="sc">-</span><span class="fu">ncol</span>(rt_cpv_df_nas)]</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_nas<span class="ot">&lt;-</span> </span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>  rt_cpv_df_nas <span class="sc">|&gt;</span> </span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Station, Longitude, Latitude,  <span class="fu">everything</span>() )</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rt_cpv_df_nas) <span class="ot">&lt;-</span> <span class="fu">append</span>(<span class="fu">colnames</span>(rt_cpv_df_nas[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),<span class="fu">as.character</span>(t_nas))</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a><span class="co"># domain2</span></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>raster_temp_stack_2_nas<span class="ot">&lt;-</span> <span class="fu">stack</span>(raster_temp_2_nas)</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>raster_temp_value_2_nas<span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(raster_temp_stack_2_nas, centroids)</span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>rt_cpv_2_nas <span class="ot">&lt;-</span> <span class="fu">cbind</span>(centroids,raster_temp_value_2_nas)</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_2_nas<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(rt_cpv_2_nas) </span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_2_nas<span class="ot">&lt;-</span> rt_cpv_df_2_nas[,<span class="sc">-</span><span class="fu">ncol</span>(rt_cpv_df_2_nas)]</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>rt_cpv_df_2_nas<span class="ot">&lt;-</span> </span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>  rt_cpv_df_2_nas <span class="sc">|&gt;</span> </span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Station, Longitude, Latitude,  <span class="fu">everything</span>() )</span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rt_cpv_df_2_nas)<span class="ot">&lt;-</span> <span class="fu">append</span>(<span class="fu">colnames</span>(rt_cpv_df_2_nas[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),<span class="fu">as.character</span>(t2_nas))</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rt_cpv_df_2_nas)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Station Longitude Latitude 2004-08-11_00:00:00 2004-08-11_01:00:00
1   17020  32.35690 41.62480            16.26486            12.82797
2   17022  31.77792 41.44924            16.93813            14.35607
3   17026  35.15450 42.02990            17.94399            17.90621
4   17069  30.39340 40.76760            20.76284            23.27804
5   17070  31.60220 40.73290            20.05142            22.38864
6   17072  31.14880 40.84370            20.31973            22.20229</code></pre>
</div>
</div>
<section id="results" class="level1" data-number="4" style="text-align: justify">
<h1 data-number="4"><span class="header-section-number">4</span> Results</h1>
<section id="derivation-of-data-frames" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="derivation-of-data-frames"><span class="header-section-number">4.1</span> Derivation of Data Frames</h2>
<p>There are four data frames, including predictions and observations, to represent each domain and assimilation version. However, these data frames are wider format and it is needed to convert them longer to use them in visualization.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-15_d491c3cfec0277ee5b64b57530ec08e0">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># domain1 assimilated prediction: rt_cpv_df</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># domain2 assimilated prediction: rt_cpv_df_2</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># domain1 non_assimilated prediction: rt_cpv_df_nas</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># domain2 non_assimilated prediction: rt_cpv_df_2_nas</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># observations: temp_obs</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>data_list<span class="ot">&lt;-</span> <span class="fu">list</span>(rt_cpv_df, rt_cpv_df_2, rt_cpv_df_nas, rt_cpv_df_2_nas)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>new_df_list<span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>variable<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"predict_do1"</span>, <span class="st">"predict_do2"</span>,<span class="st">"predict_do1_nas"</span>,<span class="st">"predict_do2_nas"</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(variable)){</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  new_df_list[[i]] <span class="ot">&lt;-</span> </span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        data_list[[i]] <span class="sc">|&gt;</span> </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">distinct</span>(Station, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">pivot_longer</span>(</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"2004"</span>),</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">names_to =</span> <span class="st">"dates"</span>,</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_to =</span> variable[i],</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_drop_na =</span> <span class="cn">FALSE</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">|&gt;</span> </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span> <span class="fu">select</span>(Station, dates, variable[i]) <span class="co"># to remove lat long column</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  new_df_list[[i]]<span class="sc">$</span>dates<span class="ot">&lt;-</span> <span class="fu">str_replace</span>(new_df_list[[i]]<span class="sc">$</span>dates, <span class="st">"_"</span>,<span class="st">" "</span>)</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  new_df_list[[i]]<span class="sc">$</span>dates<span class="ot">&lt;-</span> <span class="fu">ymd_hms</span>(new_df_list[[i]]<span class="sc">$</span>dates)</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>                            }</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="co"># domain1: new_df_list[[1]]; new_df_list[[3]]</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="co"># domain2: new_df_list[[2]]; head(new_df_list[[4]])</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(variable)){</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>new_df_list[[i]] <span class="ot">&lt;-</span> </span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>      new_df_list[[i]] <span class="sc">|&gt;</span>        </span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">left_join</span>(temp_obs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>))</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>                            }</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_df_list[[<span class="dv">1</span>]]); <span class="fu">head</span>(new_df_list[[<span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Station dates               predict_do1 observation
    &lt;dbl&gt; &lt;dttm&gt;                    &lt;dbl&gt;       &lt;dbl&gt;
1   17020 2004-08-11 00:00:00        19.1        19.1
2   17020 2004-08-11 03:00:00        16.4        18.7
3   17020 2004-08-11 06:00:00        18.6        19.9
4   17020 2004-08-11 09:00:00        22.3        18.8
5   17020 2004-08-11 12:00:00        24.5        19.2
6   17020 2004-08-11 15:00:00        22.4        20.1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Station dates               predict_do1_nas observation
    &lt;dbl&gt; &lt;dttm&gt;                        &lt;dbl&gt;       &lt;dbl&gt;
1   17020 2004-08-11 00:00:00            19.1        19.1
2   17020 2004-08-11 03:00:00            16.3        18.7
3   17020 2004-08-11 06:00:00            18.6        19.9
4   17020 2004-08-11 09:00:00            22.3        18.8
5   17020 2004-08-11 12:00:00            24.6        19.2
6   17020 2004-08-11 15:00:00            23.1        20.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_df_list[[<span class="dv">2</span>]]); <span class="fu">head</span>(new_df_list[[<span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Station dates               predict_do2 observation
    &lt;dbl&gt; &lt;dttm&gt;                    &lt;dbl&gt;       &lt;dbl&gt;
1   17020 2004-08-11 00:00:00        16.3        19.1
2   17020 2004-08-11 01:00:00        12.9        18.8
3   17020 2004-08-11 02:00:00        12.5        18.8
4   17020 2004-08-11 03:00:00        12.5        18.7
5   17020 2004-08-11 04:00:00        12.2        18.8
6   17020 2004-08-11 05:00:00        12.1        19.6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Station dates               predict_do2_nas observation
    &lt;dbl&gt; &lt;dttm&gt;                        &lt;dbl&gt;       &lt;dbl&gt;
1   17020 2004-08-11 00:00:00            16.3        19.1
2   17020 2004-08-11 01:00:00            12.8        18.8
3   17020 2004-08-11 02:00:00            12.9        18.8
4   17020 2004-08-11 03:00:00            12.4        18.7
5   17020 2004-08-11 04:00:00            12.4        18.8
6   17020 2004-08-11 05:00:00            12.1        19.6</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="visualization"><span class="header-section-number">4.2</span> Visualization</h2>
<p>Data frames were manipulated during visualization procedures depending on necessary conditions. For example, non-assimilated <em>(new_df_list[[3]])</em> and assimilated <em>(new_df_list[[1]])</em> predictions for domain 1 are combined with observations while drawing first plot below.</p>
<div class="cell" data-hash="WRF_cache/html/unnamed-chunk-16_21b888b1365296c36cc06086857b3669">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  new_df_list[[<span class="dv">1</span>]] <span class="sc">|&gt;</span>        </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(new_df_list[[<span class="dv">3</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Station dates               predict_do1 observation predict_do1_nas
    &lt;dbl&gt; &lt;dttm&gt;                    &lt;dbl&gt;       &lt;dbl&gt;           &lt;dbl&gt;
1   17020 2004-08-11 00:00:00        19.1        19.1            19.1
2   17020 2004-08-11 03:00:00        16.4        18.7            16.3
3   17020 2004-08-11 06:00:00        18.6        19.9            18.6
4   17020 2004-08-11 09:00:00        22.3        18.8            22.3
5   17020 2004-08-11 12:00:00        24.5        19.2            24.6
6   17020 2004-08-11 15:00:00        22.4        20.1            23.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  new_df_list[[<span class="dv">1</span>]] <span class="sc">|&gt;</span>        </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(new_df_list[[<span class="dv">3</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">names_to =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">values_to =</span> <span class="st">"value"</span>,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>) )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Station dates               Temperature     value
    &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;           &lt;dbl&gt;
1   17020 2004-08-11 00:00:00 predict_do1      19.1
2   17020 2004-08-11 00:00:00 observation      19.1
3   17020 2004-08-11 00:00:00 predict_do1_nas  19.1
4   17020 2004-08-11 03:00:00 predict_do1      16.4
5   17020 2004-08-11 03:00:00 observation      18.7
6   17020 2004-08-11 03:00:00 predict_do1_nas  16.3</code></pre>
</div>
</div>
<p><a href="#fig-do1" class="quarto-xref">Figure&nbsp;4</a> is shown for comparison of assimilated and non-assimilated predictions with observations for each gauge <em>(province)</em> by three hour intervals, in domain 1. In this plot, each box represent different provinces <em>(gauges)</em>, <strong>black</strong> line shows observations, <strong>red</strong> and <strong>blue</strong> lines are for <strong>assimilated</strong> and <strong>non-assimilated</strong> predictions, respectively.</p>
<p>The assimilated and non-assimilated predictions are looks like very similar. Thus, it can be said that data assimilation of temperature prediction in domain 1 has not caused major differences. Moreover, predictions are compatible with observations for some gauges such as Bolu, Kastamonu, Çankırı and etc. However, predictions are not compatible with observations for other gauges such as Sinop, Sakarya, Düzce and Samsun even the fluctuations are similar for those gauges.</p>
<div class="cell" data-hash="WRF_cache/html/fig-do1_ffc46d0b0f35754657197a8d7e464aa0">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>new_df_list[[<span class="dv">1</span>]] <span class="sc">|&gt;</span>        </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(new_df_list[[<span class="dv">3</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">names_to =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_to =</span> <span class="st">"value"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Station =</span> <span class="fu">factor</span>(Station, <span class="at">labels =</span> df_gauges<span class="sc">$</span>Province )) <span class="sc">|&gt;</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Temperature =</span>  <span class="fu">factor</span>(Temperature, </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">"observation"</span>, <span class="st">"predict_do1_nas"</span>, <span class="st">"predict_do1"</span>)) ) <span class="sc">|&gt;</span>  </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> dates, <span class="at">y=</span>value)) <span class="sc">+</span>   </span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Temperature), <span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span> <span class="fu">expression</span>(<span class="st">"Temperature"</span><span class="sc">~</span>(degree<span class="sc">*</span>C)), </span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">values =</span> <span class="fu">c</span>(<span class="st">'observation'</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1_nas'</span> <span class="ot">=</span> <span class="st">"#23bfce"</span>,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1'</span> <span class="ot">=</span> <span class="st">"#fc2852"</span>),</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'observation'</span> <span class="ot">=</span> <span class="st">'Observation'</span>,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1_nas'</span> <span class="ot">=</span> <span class="st">'Non-Assimilated Prediction DO1'</span>,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1'</span> <span class="ot">=</span> <span class="st">'Assimilated Prediction DO1'</span>)) <span class="sc">+</span> </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Station, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">" "</span>,<span class="at">y=</span><span class="fu">expression</span>(<span class="st">"Temperature"</span><span class="sc">~</span>(degree<span class="sc">*</span>C))) <span class="sc">+</span> </span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="sc">+</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">88</span>, .<span class="dv">1</span>), </span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"cornsilk"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-do1" class="quarto-figure quarto-figure-center anchored" width="864">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-do1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="WRF_files/figure-html/fig-do1-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-do1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Comparison of predictions with observations for each province in domain 1.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-sc1" class="quarto-xref">Figure&nbsp;5</a> is shown for scatterplot and heatmap of 3-hour assimilated and non-assimilated predictions versus observations in domain 1. <strong>Red</strong> and <strong>blue</strong> colors represent <strong>assimilated</strong> and <strong>non-assimilated</strong> predictions, respectively, while <strong>black</strong> line shows <strong>fit</strong> of observations versus predictions. According to the below plots, there is a clear linear relationship for 3-hour assimilated and non-assimilated predictions with observations in domain 1.</p>
<div class="cell" data-hash="WRF_cache/html/fig-sc1_4e1d274bdcb91655e1776b53d0ebebf4">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>plot1<span class="ot">&lt;-</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  new_df_list[[<span class="dv">1</span>]] <span class="sc">|&gt;</span>        </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(new_df_list[[<span class="dv">3</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"Pred.Type"</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"Prediction"</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> observation, <span class="at">y=</span>Prediction, <span class="at">color=</span>Pred.Type)) <span class="sc">+</span>   </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span>   </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span><span class="st">"black"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span> <span class="st">" "</span>, </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">values =</span> <span class="fu">c</span>(<span class="st">'predict_do1_nas'</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1'</span> <span class="ot">=</span> <span class="st">"#fc2852"</span>),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'predict_do1_nas'</span> <span class="ot">=</span> <span class="st">'Non-Assimilated Prediction DO1'</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1'</span> <span class="ot">=</span> <span class="st">'Assimilated Prediction DO1'</span>)) <span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Observation"</span>,<span class="at">y=</span><span class="st">"Prediction"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>plot2<span class="ot">&lt;-</span> </span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  new_df_list[[<span class="dv">1</span>]] <span class="sc">|&gt;</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(new_df_list[[<span class="dv">3</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"Pred.Type"</span>,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"Prediction"</span>,</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> observation, <span class="at">y=</span>Prediction, <span class="at">fill=</span>Pred.Type)) <span class="sc">+</span> </span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span> <span class="st">" "</span>,</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">'predict_do1_nas'</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'predict_do1'</span> <span class="ot">=</span> <span class="st">"red"</span>),</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'predict_do1_nas'</span> <span class="ot">=</span> <span class="st">'Non-Assimilated Prediction DO1'</span>,</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>                  <span class="st">'predict_do1'</span> <span class="ot">=</span> <span class="st">'Assimilated Prediction DO1'</span>)) <span class="sc">+</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Observation"</span>,<span class="at">y=</span><span class="st">"Prediction"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1,plot2,<span class="at">ncol=</span><span class="dv">2</span> ,<span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sc1" class="quarto-figure quarto-figure-center anchored" width="864">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="WRF_files/figure-html/fig-sc1-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-sc1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Scatterplot and heatmap of observations versus predictions in domain 1.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-do2" class="quarto-xref">Figure&nbsp;6</a> is shown for comparison of hourly assimilated and non-assimilated predictions with observations for each gauge <em>(province)</em> in domain 2. In this plot, each box represent different provinces <em>(gauges)</em>, <strong>black</strong> line shows observations, <strong>blue</strong> and <strong>red lines</strong> are for <strong>assimilated</strong> and <strong>non-assimilated</strong> predictions, respectively.</p>
<p>The assimilated and non-assimilated predictions are looks like very similar for also in domain 2. Hourly assimilated and non-assimilated predictions are compatible with observations for Bartın, Zonguldak, Kastamonu, Çorum and Samsun provinces but not remained provinces. It is the fact that 3-hour predictions are looking better than hourly ones even though domain 2 has finer resolution in both temporally and spatially. Actually, this result also should be expected since increased resolution may cause rise in error.</p>
<div class="cell" data-hash="WRF_cache/html/fig-do2_c19361b462fe0e8b66ed4263fc29758a">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>new_df_list[[<span class="dv">2</span>]] <span class="sc">|&gt;</span>        </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(new_df_list[[<span class="dv">4</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"value"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Station =</span> <span class="fu">factor</span>(Station, <span class="at">labels =</span> df_gauges<span class="sc">$</span>Province )) <span class="sc">|&gt;</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Temperature =</span>  <span class="fu">factor</span>(Temperature, </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">"observation"</span>, <span class="st">"predict_do2_nas"</span>, <span class="st">"predict_do2"</span>)) ) <span class="sc">|&gt;</span>  </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> dates, <span class="at">y=</span>value)) <span class="sc">+</span>   </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Temperature), <span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span> <span class="fu">expression</span>(<span class="st">"Temperature"</span><span class="sc">~</span>(degree<span class="sc">*</span>C)), </span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">values =</span> <span class="fu">c</span>(<span class="st">'observation'</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do2_nas'</span> <span class="ot">=</span> <span class="st">"#fc2852"</span>,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do2'</span> <span class="ot">=</span> <span class="st">"#23bfce"</span>),</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'observation'</span> <span class="ot">=</span> <span class="st">'Observation'</span>,</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do2_nas'</span> <span class="ot">=</span> <span class="st">'Non-Assimilated Prediction DO2'</span>,</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do2'</span> <span class="ot">=</span> <span class="st">'Assimilated Prediction DO2'</span>)) <span class="sc">+</span> </span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Station, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">" "</span>,<span class="at">y=</span><span class="fu">expression</span>(<span class="st">"Temperature"</span><span class="sc">~</span>(degree<span class="sc">*</span>C))) <span class="sc">+</span> </span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="sc">+</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">88</span>, .<span class="dv">1</span>), </span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"cornsilk"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-do2" class="quarto-figure quarto-figure-center anchored" width="864">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-do2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="WRF_files/figure-html/fig-do2-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-do2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Comparison of predictions with observations for each province in domain 2.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-sc2" class="quarto-xref">Figure&nbsp;7</a> is shown for scatterplot and heatmap of 1-hour assimilated and non-assimilated predictions versus observations in domain 2. <strong>Blue</strong> and <strong>red</strong> colors represent <strong>assimilated</strong> and <strong>non-assimilated</strong> predictions, respectively, while <strong>black</strong> line shows <strong>fit</strong> of observations versus predictions.</p>
<p>According to the below plots, there is not a strong relationship between hourly predictions and observations. We think that the reason of this issue is that predictions are so smooth for Sakarya, Bolu, Düzce and Amasya provinces. This situation causes two cluster on the scatterplot and fluctuated fitting line.</p>
<div class="cell" data-hash="WRF_cache/html/fig-sc2_9d04dbc94f614e8ffdba4d69586cdd25">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>plot3<span class="ot">&lt;-</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>new_df_list[[<span class="dv">2</span>]] <span class="sc">|&gt;</span>        </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(new_df_list[[<span class="dv">4</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"Pred.Type"</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"Prediction"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> observation, <span class="at">y=</span>Prediction, <span class="at">color=</span>Pred.Type)) <span class="sc">+</span>   </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span>   </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color =</span><span class="st">"black"</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span> <span class="st">" "</span>, </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">'predict_do2_nas'</span> <span class="ot">=</span> <span class="st">"#fc2852"</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">'predict_do2'</span> <span class="ot">=</span> <span class="st">"blue"</span>),</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'predict_do2_nas'</span> <span class="ot">=</span> <span class="st">'Non-Assimilated Prediction DO2'</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">'predict_do2'</span> <span class="ot">=</span> <span class="st">'Assimilated Prediction DO2'</span>)) <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Observation"</span>,<span class="at">y=</span><span class="st">"Prediction"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>plot4<span class="ot">&lt;-</span> </span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>new_df_list[[<span class="dv">2</span>]] <span class="sc">|&gt;</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(new_df_list[[<span class="dv">4</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>),</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">names_to =</span> <span class="st">"Pred.Type"</span>,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">values_to =</span> <span class="st">"Prediction"</span>,</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> observation, <span class="at">y=</span>Prediction, <span class="at">fill=</span>Pred.Type)) <span class="sc">+</span> </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>(<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span>     <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span> <span class="st">" "</span>,</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">values =</span> <span class="fu">c</span>(<span class="st">'predict_do2_nas'</span> <span class="ot">=</span> <span class="st">"#fc2852"</span>,</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'predict_do2'</span> <span class="ot">=</span> <span class="st">"blue"</span>),</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'predict_do2_nas'</span> <span class="ot">=</span> <span class="st">'Non-Assimilated Prediction DO2'</span>,</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>                      <span class="st">'predict_do2'</span> <span class="ot">=</span> <span class="st">'Assimilated Prediction DO2'</span>)) <span class="sc">+</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Observation"</span>,<span class="at">y=</span><span class="st">"Prediction"</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot3,plot4,<span class="at">ncol=</span><span class="dv">2</span> ,<span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sc2" class="quarto-figure quarto-figure-center anchored" width="864">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sc2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="WRF_files/figure-html/fig-sc2-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-sc2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Scatterplot and heatmap of observations versus predictions in domain 2.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-do1-2" class="quarto-xref">Figure&nbsp;8</a> is shown for comparison of three-hour assimilated and non-assimilated predictions with observations for each gauge <em>(province)</em> in both two domains. In this plot, each box represent different provinces <em>(gauges)</em>, <strong>black</strong> line shows observations, <strong>pink</strong> and <strong>red</strong> lines are for <strong>assimilated</strong> and <strong>non-assimilated</strong> predictions in Domain 1, respectively. Additionally, <strong>blue</strong> and <strong>lighter blue</strong> lines represent <strong>assimilated</strong> and <strong>non-assimilated</strong> predictions in Domain 2, respectively.</p>
<p>This figure is providing us to compare all predictions and observations in same plot for each province/gauge. The predictions in both two domains are compatible except smoothed ones which are mentioned above.</p>
<div class="cell" data-hash="WRF_cache/html/fig-do1-2_26557ba2090ee58a1fb9345c5c6bd1c3">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>new_df_list[[<span class="dv">1</span>]] <span class="sc">|&gt;</span>        </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(new_df_list[[<span class="dv">3</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(new_df_list[[<span class="dv">2</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(new_df_list[[<span class="dv">4</span>]], <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Station"</span>,<span class="st">"dates"</span>,<span class="st">"observation"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"value"</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_drop_na =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Station =</span> <span class="fu">factor</span>(Station, <span class="at">labels =</span> df_gauges<span class="sc">$</span>Province )) <span class="sc">|&gt;</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Temperature =</span>  <span class="fu">factor</span>(Temperature, </span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">"observation"</span>, <span class="st">"predict_do1"</span>, <span class="st">"predict_do1_nas"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"predict_do2_nas"</span>, <span class="st">"predict_do2"</span>)) ) <span class="sc">|&gt;</span> </span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> dates, <span class="at">y=</span>value)) <span class="sc">+</span>   </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour =</span> Temperature), <span class="at">size=</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name=</span> <span class="fu">expression</span>(<span class="st">"Temperature"</span><span class="sc">~</span>(degree<span class="sc">*</span>C)), </span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">values =</span> <span class="fu">c</span>(<span class="st">'observation'</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1_nas'</span> <span class="ot">=</span> <span class="st">"#fc2852"</span>,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1'</span> <span class="ot">=</span> <span class="st">"#fc95aa"</span>,</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do2_nas'</span> <span class="ot">=</span> <span class="st">"#23bfce"</span>,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do2'</span> <span class="ot">=</span> <span class="st">"#157882"</span>),</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'observation'</span> <span class="ot">=</span> <span class="st">'Observation'</span>,</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1_nas'</span> <span class="ot">=</span> <span class="st">'Non-Assimilated Prediction DO1'</span>,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do1'</span> <span class="ot">=</span> <span class="st">'Assimilated Prediction DO1'</span>,</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do2_nas'</span> <span class="ot">=</span> <span class="st">'Non-Assimilated Prediction DO2'</span>,</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'predict_do2'</span> <span class="ot">=</span> <span class="st">'Assimilated Prediction DO2'</span>)) <span class="sc">+</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Station, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span> </span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">" "</span>,<span class="at">y=</span><span class="fu">expression</span>(<span class="st">"Temperature"</span><span class="sc">~</span>(degree<span class="sc">*</span>C))) <span class="sc">+</span> </span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">1</span>))  <span class="sc">+</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">88</span>, .<span class="dv">1</span>), </span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"black"</span>, <span class="at">fill=</span><span class="st">"cornsilk"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-do1-2" class="quarto-figure quarto-figure-center anchored" width="864">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-do1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="WRF_files/figure-html/fig-do1-2-1.png" class="img-fluid figure-img" width="864">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-do1-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Comparison of predictions with observations for each province in both two domains.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="error-analysis" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="error-analysis"><span class="header-section-number">4.3</span> Error Analysis</h2>
<p>This part calculates various error metrics, including bias, mean squared error (MSE), root mean squared error (RMSE), normalized RMSE (NRMSE), and correlation coefficients for the predictions. <a href="#tbl-stats" class="quarto-xref">Table&nbsp;2</a> shows the error statistics for both domains with respect to complete assimilated and non-assimilated predictions.</p>
<p>As anticipated, prediction errors in domain 2 surpass those in domain 1, resulting in a less favorable correlation coefficient. Surprisingly, when comparing assimilated prediction errors with their non-assimilated counterparts within each domain, there is no significant reduction in errors. We think that this situation is also caused smoothed predictions as mentioned previously. Thus, errors for only Kastamunu province which has more appropriate predictions in both domains is given below. Additionally, to examine the opposite of this situation Düzce case is also given below.</p>
<div class="cell" data-hash="WRF_cache/html/tbl-stats_13e0e40521c0a5a0b58826b7b1463888">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#BIAS</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {<span class="fu">mean</span>((x<span class="sc">-</span>y), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">#MSE</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>mse<span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {<span class="fu">mean</span>((x<span class="sc">-</span>y)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)}</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#RMSE</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>rmse<span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {<span class="fu">sqrt</span>( <span class="fu">mean</span>( (x<span class="sc">-</span>y)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) )}</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">#NRMSE</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>nrmse<span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){<span class="fu">sqrt</span>( <span class="fu">mean</span>((x<span class="sc">-</span>y)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) ) <span class="sc">/</span> (<span class="fu">max</span>(x)<span class="sc">-</span><span class="fu">min</span>(y))}</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="co"># domain1: new_df_list[[1]]; new_df_list[[3]]</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># domain2: new_df_list[[2]]; head(new_df_list[[4]])</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>error_table<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Statistics =</span> <span class="fu">c</span>(<span class="st">"BIAS"</span>,<span class="st">"MSE"</span>,<span class="st">"RMSE"</span>,<span class="st">"NRMSE"</span>,<span class="st">"COR.COEF"</span>), </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Assim_DO1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Assim_DO2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Non_Assim_DO1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,   </span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Non_Assim_DO2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">1</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">bias</span>(<span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">4</span>]), </span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">3</span>]))</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">2</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mse</span>(<span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">4</span>]), </span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">3</span>]))</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">3</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rmse</span>(<span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">4</span>]), </span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">3</span>]))</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">4</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">nrmse</span>(<span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">4</span>]), </span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">3</span>]))</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">5</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">4</span>]), </span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(new_df_list[[i]][,<span class="dv">3</span>]), <span class="at">use=</span><span class="st">'pairwise.complete.obs'</span>)</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>               }</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>error_table[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="ot">&lt;-</span> <span class="fu">round</span>(error_table[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],<span class="dv">4</span>)</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>error_table <span class="sc">|&gt;</span>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-stats" class="cell anchored" data-hash="WRF_cache/html/tbl-stats_13e0e40521c0a5a0b58826b7b1463888">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="table quarto-float-caption quarto-float-tbl" id="tbl-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Error statistics of entire predictions in each domain.
</figcaption>
<div aria-describedby="tbl-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ihyjpqtnnf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ihyjpqtnnf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ihyjpqtnnf thead, #ihyjpqtnnf tbody, #ihyjpqtnnf tfoot, #ihyjpqtnnf tr, #ihyjpqtnnf td, #ihyjpqtnnf th {
  border-style: none;
}

#ihyjpqtnnf p {
  margin: 0;
  padding: 0;
}

#ihyjpqtnnf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ihyjpqtnnf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ihyjpqtnnf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ihyjpqtnnf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ihyjpqtnnf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ihyjpqtnnf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihyjpqtnnf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ihyjpqtnnf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ihyjpqtnnf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ihyjpqtnnf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ihyjpqtnnf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ihyjpqtnnf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ihyjpqtnnf .gt_spanner_row {
  border-bottom-style: hidden;
}

#ihyjpqtnnf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ihyjpqtnnf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ihyjpqtnnf .gt_from_md > :first-child {
  margin-top: 0;
}

#ihyjpqtnnf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ihyjpqtnnf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ihyjpqtnnf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ihyjpqtnnf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ihyjpqtnnf .gt_row_group_first td {
  border-top-width: 2px;
}

#ihyjpqtnnf .gt_row_group_first th {
  border-top-width: 2px;
}

#ihyjpqtnnf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihyjpqtnnf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ihyjpqtnnf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ihyjpqtnnf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihyjpqtnnf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihyjpqtnnf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ihyjpqtnnf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ihyjpqtnnf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ihyjpqtnnf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ihyjpqtnnf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ihyjpqtnnf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihyjpqtnnf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ihyjpqtnnf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ihyjpqtnnf .gt_left {
  text-align: left;
}

#ihyjpqtnnf .gt_center {
  text-align: center;
}

#ihyjpqtnnf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ihyjpqtnnf .gt_font_normal {
  font-weight: normal;
}

#ihyjpqtnnf .gt_font_bold {
  font-weight: bold;
}

#ihyjpqtnnf .gt_font_italic {
  font-style: italic;
}

#ihyjpqtnnf .gt_super {
  font-size: 65%;
}

#ihyjpqtnnf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ihyjpqtnnf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ihyjpqtnnf .gt_indent_1 {
  text-indent: 5px;
}

#ihyjpqtnnf .gt_indent_2 {
  text-indent: 10px;
}

#ihyjpqtnnf .gt_indent_3 {
  text-indent: 15px;
}

#ihyjpqtnnf .gt_indent_4 {
  text-indent: 20px;
}

#ihyjpqtnnf .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Statistics" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Statistics</th>
<th id="Assim_DO1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Assim_DO1</th>
<th id="Assim_DO2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Assim_DO2</th>
<th id="Non_Assim_DO1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Non_Assim_DO1</th>
<th id="Non_Assim_DO2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Non_Assim_DO2</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">BIAS</td>
<td class="gt_row gt_right" headers="Assim_DO1">2.1705</td>
<td class="gt_row gt_right" headers="Assim_DO2">2.0086</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">2.1191</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">1.9911</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistics">MSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">15.5098</td>
<td class="gt_row gt_right" headers="Assim_DO2">30.5784</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">15.3419</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">30.4394</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">RMSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">3.9383</td>
<td class="gt_row gt_right" headers="Assim_DO2">5.5298</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">3.9169</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">5.5172</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistics">NRMSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">0.1536</td>
<td class="gt_row gt_right" headers="Assim_DO2">0.1927</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">0.1524</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">0.1924</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">COR.COEF</td>
<td class="gt_row gt_right" headers="Assim_DO1">0.7477</td>
<td class="gt_row gt_right" headers="Assim_DO2">0.3793</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">0.7466</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">0.3812</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-kastamonu" class="quarto-xref">Table&nbsp;3</a> shows the error statistics with respect to assimilated and non-assimilated predictions for <strong>Kastamonu</strong> province in both domains. When we investigate the results for only Kastamunu gauge/province assimilated predictions have less errors slightly and better correlation than non-assimilated ones in both domains.</p>
<div class="cell" data-hash="WRF_cache/html/tbl-kastamonu_02340445733840909b8d081e712e5c9e">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>error_table<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Statistics =</span> <span class="fu">c</span>(<span class="st">"BIAS"</span>,<span class="st">"MSE"</span>,<span class="st">"RMSE"</span>,<span class="st">"NRMSE"</span>,<span class="st">"COR.COEF"</span>), </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Assim_DO1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Assim_DO2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Non_Assim_DO1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,   </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Non_Assim_DO2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  kastamonu<span class="ot">&lt;-</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>      new_df_list[[i]] <span class="sc">|&gt;</span> </span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">Station =</span> <span class="fu">factor</span>(Station, <span class="at">labels =</span> df_gauges<span class="sc">$</span>Province )) <span class="sc">|&gt;</span> </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(Station <span class="sc">==</span> <span class="st">"Kastamonu"</span> )</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">1</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">bias</span>(<span class="fu">as.matrix</span>(kastamonu[,<span class="dv">4</span>]), </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(kastamonu[,<span class="dv">3</span>]))</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">2</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mse</span>(<span class="fu">as.matrix</span>(kastamonu[,<span class="dv">4</span>]), </span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(kastamonu[,<span class="dv">3</span>]))</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">3</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rmse</span>(<span class="fu">as.matrix</span>(kastamonu[,<span class="dv">4</span>]), </span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(kastamonu[,<span class="dv">3</span>]))</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">4</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">nrmse</span>(<span class="fu">as.matrix</span>(kastamonu[,<span class="dv">4</span>]), </span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(kastamonu[,<span class="dv">3</span>]))</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  error_table[<span class="dv">5</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="fu">as.matrix</span>(kastamonu[,<span class="dv">4</span>]), </span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">as.matrix</span>(kastamonu[,<span class="dv">3</span>]), <span class="at">use=</span><span class="st">'pairwise.complete.obs'</span>)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>               }</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>error_table[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]<span class="ot">&lt;-</span> <span class="fu">round</span>(error_table[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],<span class="dv">4</span>)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>error_table <span class="sc">|&gt;</span>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-kastamonu" class="cell anchored" data-hash="WRF_cache/html/tbl-kastamonu_02340445733840909b8d081e712e5c9e">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="table quarto-float-caption quarto-float-tbl" id="tbl-kastamonu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Error statistics of predictions for Kastomonu province in each domain.
</figcaption>
<div aria-describedby="tbl-kastamonu-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="yrmqkawswl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yrmqkawswl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yrmqkawswl thead, #yrmqkawswl tbody, #yrmqkawswl tfoot, #yrmqkawswl tr, #yrmqkawswl td, #yrmqkawswl th {
  border-style: none;
}

#yrmqkawswl p {
  margin: 0;
  padding: 0;
}

#yrmqkawswl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yrmqkawswl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yrmqkawswl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yrmqkawswl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yrmqkawswl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yrmqkawswl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yrmqkawswl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yrmqkawswl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yrmqkawswl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yrmqkawswl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yrmqkawswl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yrmqkawswl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yrmqkawswl .gt_spanner_row {
  border-bottom-style: hidden;
}

#yrmqkawswl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yrmqkawswl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yrmqkawswl .gt_from_md > :first-child {
  margin-top: 0;
}

#yrmqkawswl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yrmqkawswl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yrmqkawswl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yrmqkawswl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yrmqkawswl .gt_row_group_first td {
  border-top-width: 2px;
}

#yrmqkawswl .gt_row_group_first th {
  border-top-width: 2px;
}

#yrmqkawswl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yrmqkawswl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yrmqkawswl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yrmqkawswl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yrmqkawswl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yrmqkawswl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yrmqkawswl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yrmqkawswl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yrmqkawswl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yrmqkawswl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yrmqkawswl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yrmqkawswl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yrmqkawswl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yrmqkawswl .gt_left {
  text-align: left;
}

#yrmqkawswl .gt_center {
  text-align: center;
}

#yrmqkawswl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yrmqkawswl .gt_font_normal {
  font-weight: normal;
}

#yrmqkawswl .gt_font_bold {
  font-weight: bold;
}

#yrmqkawswl .gt_font_italic {
  font-style: italic;
}

#yrmqkawswl .gt_super {
  font-size: 65%;
}

#yrmqkawswl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yrmqkawswl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yrmqkawswl .gt_indent_1 {
  text-indent: 5px;
}

#yrmqkawswl .gt_indent_2 {
  text-indent: 10px;
}

#yrmqkawswl .gt_indent_3 {
  text-indent: 15px;
}

#yrmqkawswl .gt_indent_4 {
  text-indent: 20px;
}

#yrmqkawswl .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Statistics" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Statistics</th>
<th id="Assim_DO1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Assim_DO1</th>
<th id="Assim_DO2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Assim_DO2</th>
<th id="Non_Assim_DO1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Non_Assim_DO1</th>
<th id="Non_Assim_DO2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Non_Assim_DO2</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">BIAS</td>
<td class="gt_row gt_right" headers="Assim_DO1">-0.7900</td>
<td class="gt_row gt_right" headers="Assim_DO2">3.5949</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">-0.8210</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">3.5408</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistics">MSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">9.2272</td>
<td class="gt_row gt_right" headers="Assim_DO2">20.2453</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">9.2425</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">19.9165</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">RMSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">3.0376</td>
<td class="gt_row gt_right" headers="Assim_DO2">4.4995</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">3.0401</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">4.4628</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistics">NRMSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">0.1469</td>
<td class="gt_row gt_right" headers="Assim_DO2">0.1991</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">0.1469</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">0.1976</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">COR.COEF</td>
<td class="gt_row gt_right" headers="Assim_DO1">0.8009</td>
<td class="gt_row gt_right" headers="Assim_DO2">0.8327</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">0.8026</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">0.8304</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-duzce" class="quarto-xref">Table&nbsp;4</a> shows the error statistics with respect to assimilated and non-assimilated predictions for <strong>Düzce</strong> province in both two domains. In this example, errors are bigger in assimilated versions and correlation coefficients smaller in domain 2.</p>
<div class="cell" data-hash="WRF_cache/html/tbl-duzce_d760c58b8210e76b0a38d84622c500cf">
<div id="tbl-duzce" class="cell anchored" data-hash="WRF_cache/html/tbl-duzce_d760c58b8210e76b0a38d84622c500cf">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="table quarto-float-caption quarto-float-tbl" id="tbl-duzce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Error statistics of predictions for Duzce province in each domain.
</figcaption>
<div aria-describedby="tbl-duzce-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="mhsdnbfcft" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mhsdnbfcft table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mhsdnbfcft thead, #mhsdnbfcft tbody, #mhsdnbfcft tfoot, #mhsdnbfcft tr, #mhsdnbfcft td, #mhsdnbfcft th {
  border-style: none;
}

#mhsdnbfcft p {
  margin: 0;
  padding: 0;
}

#mhsdnbfcft .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mhsdnbfcft .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mhsdnbfcft .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mhsdnbfcft .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mhsdnbfcft .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhsdnbfcft .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhsdnbfcft .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhsdnbfcft .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mhsdnbfcft .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mhsdnbfcft .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mhsdnbfcft .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mhsdnbfcft .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mhsdnbfcft .gt_spanner_row {
  border-bottom-style: hidden;
}

#mhsdnbfcft .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mhsdnbfcft .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mhsdnbfcft .gt_from_md > :first-child {
  margin-top: 0;
}

#mhsdnbfcft .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mhsdnbfcft .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mhsdnbfcft .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mhsdnbfcft .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mhsdnbfcft .gt_row_group_first td {
  border-top-width: 2px;
}

#mhsdnbfcft .gt_row_group_first th {
  border-top-width: 2px;
}

#mhsdnbfcft .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhsdnbfcft .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mhsdnbfcft .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mhsdnbfcft .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhsdnbfcft .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhsdnbfcft .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mhsdnbfcft .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mhsdnbfcft .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mhsdnbfcft .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhsdnbfcft .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhsdnbfcft .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhsdnbfcft .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhsdnbfcft .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhsdnbfcft .gt_left {
  text-align: left;
}

#mhsdnbfcft .gt_center {
  text-align: center;
}

#mhsdnbfcft .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mhsdnbfcft .gt_font_normal {
  font-weight: normal;
}

#mhsdnbfcft .gt_font_bold {
  font-weight: bold;
}

#mhsdnbfcft .gt_font_italic {
  font-style: italic;
}

#mhsdnbfcft .gt_super {
  font-size: 65%;
}

#mhsdnbfcft .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mhsdnbfcft .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mhsdnbfcft .gt_indent_1 {
  text-indent: 5px;
}

#mhsdnbfcft .gt_indent_2 {
  text-indent: 10px;
}

#mhsdnbfcft .gt_indent_3 {
  text-indent: 15px;
}

#mhsdnbfcft .gt_indent_4 {
  text-indent: 20px;
}

#mhsdnbfcft .gt_indent_5 {
  text-indent: 25px;
}
</style>

<table class="gt_table cell table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="Statistics" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Statistics</th>
<th id="Assim_DO1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Assim_DO1</th>
<th id="Assim_DO2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Assim_DO2</th>
<th id="Non_Assim_DO1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Non_Assim_DO1</th>
<th id="Non_Assim_DO2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Non_Assim_DO2</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">BIAS</td>
<td class="gt_row gt_right" headers="Assim_DO1">4.3474</td>
<td class="gt_row gt_right" headers="Assim_DO2">-1.9797</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">4.3616</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">-1.9523</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistics">MSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">24.4499</td>
<td class="gt_row gt_right" headers="Assim_DO2">20.1177</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">24.7878</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">19.6618</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">RMSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">4.9447</td>
<td class="gt_row gt_right" headers="Assim_DO2">4.4853</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">4.9787</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">4.4342</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Statistics">NRMSE</td>
<td class="gt_row gt_right" headers="Assim_DO1">0.2174</td>
<td class="gt_row gt_right" headers="Assim_DO2">0.3537</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">0.2174</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">0.3497</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Statistics">COR.COEF</td>
<td class="gt_row gt_right" headers="Assim_DO1">0.8513</td>
<td class="gt_row gt_right" headers="Assim_DO2">0.3535</td>
<td class="gt_row gt_right" headers="Non_Assim_DO1">0.8473</td>
<td class="gt_row gt_right" headers="Non_Assim_DO2">0.3886</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level1" data-number="5" style="text-align: justify">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusion</h1>
<p>The goal of our study was to identify and analyse the effects of data assimilation of WRF predictions over northwestern Türkiye. For this purpose, we compared the both assimilated and non-assimilated WRF temperature predictions with corresponding observations for between 11 and 16 August, 2004. As shown in the result part, for some locations, the predictions and observations agree with each other, while rest of them are not in this case. It is not possible to draw definite conclusions about the effects of data assimilation of WRF based on this example alone. More case studies in the same region and in different seasons should be carried out in order to make clearer determinations. However, the integration of the WRF model with data assimilation techniques has proven to be a valuable tool for advancing our understanding of regional weather patterns. The outcomes of this study have practical applications in operational forecasting, research endeavors, and emergency response, contributing to the broader field of atmospheric science.</p>
</section>




<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bao2015" class="csl-entry" role="listitem">
Bao, Y., J. Xu, A. M. Powell Jr., M. Shao, J. Min, and Y. Pan. 2015. <span>“Impacts of AMSU-A, MHS and IASI Data Assimilation on Temperature and Humidity Forecasts with GSI<span></span>WRF over the Western United States.”</span> <em>Atmospheric Measurement Techniques</em> 8 (10): 4231–42. <a href="https://doi.org/10.5194/amt-8-4231-2015">https://doi.org/10.5194/amt-8-4231-2015</a>.
</div>
<div id="ref-R.utils" class="csl-entry" role="listitem">
Bengtsson, Henrik. 2023. <span>“R.utils: Various Programming Utilities.”</span> <a href="https://CRAN.R-project.org/package=R.utils">https://CRAN.R-project.org/package=R.utils</a>.
</div>
<div id="ref-cheng2017" class="csl-entry" role="listitem">
Cheng, William Y. Y., Yubao Liu, Alfred J. Bourgeois, Yonghui Wu, and Sue Ellen Haupt. 2017. <span>“Short-Term Wind Forecast of a Data Assimilation/Weather Forecasting System with Wind Turbine Anemometer Measurement Assimilation.”</span> <em>Renewable Energy</em> 107 (July): 340–51. <a href="https://doi.org/10.1016/j.renene.2017.02.014">https://doi.org/10.1016/j.renene.2017.02.014</a>.
</div>
<div id="ref-frnda2022" class="csl-entry" role="listitem">
Frnda, Jaroslav, Marek Durica, Jan Rozhon, Maria Vojtekova, Jan Nedoma, and Radek Martinek. 2022. <span>“ECMWF Short-Term Prediction Accuracy Improvement by Deep Learning.”</span> <em>Scientific Reports</em> 12 (1). <a href="https://doi.org/10.1038/s41598-022-11936-9">https://doi.org/10.1038/s41598-022-11936-9</a>.
</div>
<div id="ref-geer2018" class="csl-entry" role="listitem">
Geer, Alan J., Katrin Lonitz, Peter Weston, Masahiro Kazumori, Kozo Okamoto, Yanqiu Zhu, Emily Huichun Liu, et al. 2018. <span>“All<span>-</span>Sky Satellite Data Assimilation at Operational Weather Forecasting Centres.”</span> <em>Quarterly Journal of the Royal Meteorological Society</em> 144 (713): 1191–1217. <a href="https://doi.org/10.1002/qj.3202">https://doi.org/10.1002/qj.3202</a>.
</div>
<div id="ref-raster" class="csl-entry" role="listitem">
Hijmans, Robert J. 2023. <span>“Raster: Geographic Data Analysis and Modeling.”</span> <a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>.
</div>
<div id="ref-gt" class="csl-entry" role="listitem">
Iannone, Richard, Joe Cheng, Barret Schloerke, Ellis Hughes, Alexandra Lauer, and JooYoung Seo. 2023. <span>“Gt: Easily Create Presentation-Ready Display Tables.”</span> <a href="https://CRAN.R-project.org/package=gt">https://CRAN.R-project.org/package=gt</a>.
</div>
<div id="ref-ggpubr-2" class="csl-entry" role="listitem">
Kassambara, Alboukadel. 2023. <span>“Ggpubr: ’Ggplot2’ Based Publication Ready Plots.”</span> <a href="https://CRAN.R-project.org/package=ggpubr">https://CRAN.R-project.org/package=ggpubr</a>.
</div>
<div id="ref-rnaturalearth" class="csl-entry" role="listitem">
Massicotte, Philippe, and Andy South. 2023. <span>“Rnaturalearth: World Map Data from Natural Earth.”</span> <a href="https://CRAN.R-project.org/package=rnaturalearth">https://CRAN.R-project.org/package=rnaturalearth</a>.
</div>
<div id="ref-sf" class="csl-entry" role="listitem">
Pebesma, Edzer, and Roger Bivand. 2023. <span>“<span></span>Spatial Data Science: With Applications in r<span></span>.”</span> <a href="https://doi.org/10.1201/9780429459016">https://doi.org/10.1201/9780429459016</a>.
</div>
<div id="ref-ncdf4" class="csl-entry" role="listitem">
Pierce, David. 2023. <span>“Ncdf4: Interface to Unidata netCDF (Version 4 or Earlier) Format Data Files.”</span> <a href="https://CRAN.R-project.org/package=ncdf4">https://CRAN.R-project.org/package=ncdf4</a>.
</div>
<div id="ref-powers2017" class="csl-entry" role="listitem">
Powers, Jordan G., Joseph B. Klemp, William C. Skamarock, Christopher A. Davis, Jimy Dudhia, David O. Gill, Janice L. Coen, et al. 2017. <span>“The Weather Research and Forecasting Model: Overview, System Efforts, and Future Directions.”</span> <em>Bulletin of the American Meteorological Society</em> 98 (8): 1717–37. <a href="https://doi.org/10.1175/bams-d-15-00308.1">https://doi.org/10.1175/bams-d-15-00308.1</a>.
</div>
<div id="ref-vladimirov2020" class="csl-entry" role="listitem">
Vladimirov, Evgeni, Reneta Dimitrova, and Ventsislav Danchovski. 2020. <span>“Correction to: Impact of Data Assimilation on Short-Term Precipitation Forecasts Using WRF-ARW Model.”</span> In, C1–1. Springer International Publishing. <a href="https://doi.org/10.1007/978-3-030-41032-2_73">https://doi.org/10.1007/978-3-030-41032-2_73</a>.
</div>
<div id="ref-ggplot2-2" class="csl-entry" role="listitem">
Wickham, Hadley. 2016. <span>“Ggplot2: Elegant Graphics for Data Analysis.”</span> <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span></span>Tidyverse<span></span>”</span> 4: 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
<div id="ref-readxl" class="csl-entry" role="listitem">
Wickham, Hadley, and Jennifer Bryan. 2023. <span>“Readxl: Read Excel Files.”</span> <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.
</div>
<div id="ref-yucel2014" class="csl-entry" role="listitem">
Yucel, I., and A. Onen. 2014. <span>“Evaluating a Mesoscale Atmosphere Model and a Satellite-Based Algorithm in Estimating Extreme Rainfall Events in Northwestern Turkey.”</span> <em>Natural Hazards and Earth System Sciences</em> 14 (3): 611–24. <a href="https://doi.org/10.5194/nhess-14-611-2014">https://doi.org/10.5194/nhess-14-611-2014</a>.
</div>
<div id="ref-yucel2015" class="csl-entry" role="listitem">
Yucel, I., A. Onen, K. K. Yilmaz, and D. J. Gochis. 2015. <span>“Calibration and Evaluation of a Flood Forecasting System: Utility of Numerical Weather Prediction Model, Data Assimilation and Satellite-Based Rainfall.”</span> <em>Journal of Hydrology</em> 523 (April): 49–66. <a href="https://doi.org/10.1016/j.jhydrol.2015.01.042">https://doi.org/10.1016/j.jhydrol.2015.01.042</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>